import matplotlib.pyplot as plt
from matplotlib import cm
import torch as tc
from matplotlib.ticker import MultipleLocator, FormatStrFormatter
import numpy as np

a = [2000,3000,4000,5000,6000,7000,8000,9000,10000,11000,12000,14000,16000]#train sample

#QPNN
b100 = [0.2413,0.1478,0.2254,0.2363,0.1831,0.2386,0.1326,0.2261,0.2011,0.1498,0.1605,0.1800]#0.38985,0.022,0.058,0.027,0.15355,0.001,0.023
b200 = [0.1335,0.2965,0.2024,0.1877,0.2266,0.1924,0.2397,0.1792,0.1721,0.1461,0.1425,0.1870]#0.8105
b500 = [0.1142,0.1626,0.1397,0.0985,0.1676,0.1655,0.1845,0.0876,0.1867,0.1011,0.1492,0.0797]
b1000 = [0.0713,0.0716,0.0904,0.1037,0.1957,0.1024,0.0862,0.0924,0.1106,0.0745,0.0751,0.0796]
b2000 = [0.0733,0.2088,0.0849,0.1115,0.0723,0.0986,0.0772,0.0726,0.1257,0.0587]#,0.0679,0.0965
b3000 = [0.0472,0.0657,0.0778,0.0935,0.0793,0.0883,0.0713,0.0467,0.0716,0.0634]
b4000 = [0.1471,0.0632,0.0482,0.0397,0.1271,0.0593,0.0662,0.0532,0.0846,0.0488]#,0.0625,0.0607
b5000 =[0.0677,0.0494,0.0772,0.0502,0.0484,0.0459,0.0971,0.0435,0.0746,0.0538]
b6000 = [0.1018,0.0471,0.0366,0.00559,0.0475,0.0589,0.0322,0.0451,0.0751,0.0812]#,0.0667,0.0468
b7000 =[0.0528,0.0337,0.0371,0.0419,0.0446,0.0569,0.0487,0.0341,0.0434,0.0449]
b8000 = [0.0484,0.0490,0.0562,0.0561,0.0825,0.0990,0.0457,0.0607,0.0659,0.0592]#,0.0286,0.0321
b9000 =[0.0414,0.0766,0.035,0.101,0.0428,0.0429,0.0551,0.0536,0.0407,0.0345]
b10000 = [0.0661,0.04,0.0222,0.0394,0.0334,0.0334,0.0968,0.1125,0.0399,0.0408]#,0.0436,0.0543
b11000 = [0.0263,0.0439,0.0483,0.0363,0.0351,0.0233,0.0241,0.0338,0.0397,0.0329]
b12000 = [0.0836,0.0406,0.0409,0.0566,0.0318,0.0432,0.0537,0.0422,0.0379,0.0329]
b14000 = [0.0403,0.0644,0.0551,0.0335,0.0675,0.06,0.0291,0.0712,0.0309,0.0362]
b16000 = [0.0306,0.0423,0.0224,0.0326,0.0294,0.0272,0.0367,0.0259,0.0275,0.0277]
# dd = [1,2,3,4,5]
# b100mean = np.mean(b100)
# b200mean = np.mean(b200)
# b500mean = np.mean(b500)
# b1000mean = np.mean(b1000)
b2000mean = np.mean(b2000)
b3000mean = np.mean(b3000)
b4000mean = np.mean(b4000)
b5000mean = np.mean(b5000)
b6000mean = np.mean(b6000)
b7000mean = np.mean(b7000)
b8000mean = np.mean(b8000)
b9000mean = np.mean(b9000)
b10000mean = np.mean(b10000)
b11000mean = np.mean(b11000)
b12000mean = np.mean(b12000)
b14000mean = np.mean(b14000)
b16000mean = np.mean(b16000)
print(b14000mean,b16000mean)
# print(b2000mean,b3000mean,b4000mean,b5000mean,b6000mean,b7000mean,b8000mean,b9000mean,b10000mean,b11000mean,b12000mean)
# bmean = [0.21208,0.20652,0.14135,0.10585,0.10823,0.08077,0.04958,0.0652,0.03908]#6zu
# bmean = [0.19355,0.19214,0.13641,0.09612,0.09567,0.07172,0.05372,0.05695,0.051867]#12zu
bmean = [0.09836,0.07048,0.07374,0.06078,0.05311,0.04381,0.0623,0.0524,0.0525,0.03437,0.04634,0.0488,0.0302]#12zu2000开始
# errorbar100 = np.std(b100)
# errorbar200 = np.std(b200)
# errorbar500 = np.std(b500)
# errorbar1000 = np.std(b1000)
errorbar2000 = np.var(b2000)
errorbar3000 = np.var(b3000)
errorbar4000 = np.var(b4000)
errorbar5000 = np.var(b5000)
errorbar6000 = np.var(b6000)
errorbar7000 = np.var(b7000)
errorbar8000 = np.var(b8000)
errorbar9000 = np.var(b9000)
errorbar10000 = np.var(b10000)
errorbar11000 = np.var(b11000)
errorbar12000 = np.var(b12000)
errorbar14000 = np.var(b14000)
errorbar16000 = np.var(b16000)
print(errorbar14000,errorbar16000)
# bvar_list_up = [0.19355+0.0014,0.19214+0.00192,0.13641+0.00135,0.09612+0.00106,0.09567+0.00151,0.07172+0.00098,0.05372+0.00058,0.05695+0.00035,0.051867+0.00067]#12zu
# bvar_listdown = [0.19355-0.0014,0.19214-0.00192,0.13641-0.00135,0.09612-0.00106,0.09567-0.00151,0.07172-0.00098,0.05372-0.00058,0.05695-0.00035,0.051867-0.00067]
bvar_list_up = [0.09836+0.00173,0.07048+0.000216,0.07374+0.00116,0.06078+0.00028,0.05311+0.00068,0.04381+0.00005,0.0623+0.00025,0.0524+0.0004,0.0525+0.0008,0.03437+0.0006,0.04634+0.0002,0.0488+0.0002,0.0302+0.00003]#2000开始
bvar_listdown = [0.09836-0.00173,0.07048-0.000216,0.07374-0.00116,0.06078-0.00028,0.05311-0.00068,0.04381-0.00005,0.0623-0.00025,0.0524-0.0004,0.0525-0.0008,0.03437-0.0006,0.04634-0.0002,0.0488-0.0002,0.0302-0.00003]
# print(errorbar2000,errorbar3000,errorbar4000,errorbar5000,errorbar6000,errorbar7000,errorbar8000,errorbar9000,errorbar10000,errorbar11000,errorbar12000)
bvar = [0.0014,0.00192,0.00135,0.00106,0.00151,0.00098,0.00058,0.00035,0.00067]#12zu
# bstd_list_up = [0.19355+0.0381,0.19214+0.0439,0.13641+0.0369,0.09612+0.0326,0.09567+0.0389,0.07172+0.0314,0.05372+0.0241,0.05695+0.0187,0.051867+0.026]
# bstd_listdown = [0.19355-0.0381,0.19214-0.0439,0.13641-0.0369,0.09612-0.0326,0.09567-0.0389,0.07172-0.0314,0.05372-0.0241,0.05695-0.0187,0.051867-0.026]
bstd_list_up = [0.09567+0.0389,0.07172+0.0314,0.05372+0.0241,0.05695+0.0187,0.051867+0.026]#2000开始
bstd_listdown = [0.09567-0.0389,0.07172-0.0314,0.05372-0.0241,0.05695-0.0187,0.051867-0.026]

#MPNN
c1 = [0.4504,0.6445,0.1789,0.0949,0.0965,0.0164,0.0407,0.0142,0.0038]#MPNN error
c100 = [0.4504,0.5881,0.6241,0.7715,0.1419,1.2933,1.7597,0.13,0.7556,0.354,1.2733,0.9161]
c200 = [0.6445,0.3760,0.5009,0.6864,0.1593,0.5762,0.1183,0.3697,1.1427,0.5488,0.5435,0.0543]
c500 = [0.1789,0.1984,0.0915,0.3890,0.1313,0.0913,0.1367,0.0773,2.0417,0.0693,0.8034,0.2038]#
c1000 = [0.0949,0.6662,0.0458,0.9169,0.0209,0.2897,0.0297,2.6129,0.0122,0.0207,0.0136,0.0206]#0.7402
c1000new = [0.5019,0.0191,0.1212,0.266,1.2063,0.0076,0.0192,0.0459,0.0272,0.0124,0.1858,0.0257]
c2000 = [0.0965,0.0071,0.0088,0.0161,0.0094,0.0205,0.096,0.009,0.0192,0.0471]#,0.0172,0.0324
c3000 = [0.0094,0.0076,0.0068,0.0261,0.0228,0.0208,0.0094,0.0794,0.0171,0.0072]
c4000 = [0.0164,0.0082,0.0730,0.0108,0.1685,0.0079,0.0333,0.0046,0.0054,0.0072]#,0.0132,0.0086
c5000 = [0.0156,0.0081,0.042,0.0124,0.008,0.0159,0.0169,0.0193,0.0201,0.0066]
c6000 = [0.0407,0.0071,0.0387,0.0061,0.0147,0.0106,0.0044,0.012,0.0218,0.0047]#,0.0735,0.0053
c7000 = [0.0113,0.0183,0.0054,0.0101,0.0045,0.0077,0.0074,0.0052,0.0047,0.0083]
c8000 = [0.0142,0.0070,0.0051,0.0057,0.0093,0.0035,0.0042,0.0042,0.0047,0.0084]#,0.0057,0.0283
c9000 = [0.0192,0.0043,0.0046,0.0113,0.0038,0.012,0.0123,0.0037,0.0041,0.0056]
c10000 = [0.0038,0.0044,0.0062,0.0063,0.0049,0.0060,0.009,0.0034,0.0318,0.0168]#,0.0074,0.0107
c11000 = [0.0045,0.0051,0.0151,0.0116,0.0053,0.0043,0.0047,0.0186,0.006,0.0042]
c12000 = [0.0063,0.0044,0.0043,0.017,0.0069,0.0099,0.018,0.0338,0.0087,0.0031]
c14000 = [0.0044,0.0044,0.0063,0.0308,0.0129,0.0099,0.0148,0.0106,0.0046,0.0071]
c16000 = [0.0103,0.0076,0.0042,0.0209,0.0193,0.0034,0.0057,0.009,0.0246,0.0045]
# dd = [1,2,3,4,5]
c100mean = np.mean(c100)
c200mean = np.mean(c200)
c500mean = np.mean(c500)
c1000mean = np.mean(c1000)
c2000mean = np.mean(c2000)
c3000mean = np.mean(c3000)
c4000mean = np.mean(c4000)
c5000mean = np.mean(c5000)
c6000mean = np.mean(c6000)
c7000mean = np.mean(c7000)
c8000mean = np.mean(c8000)
c9000mean = np.mean(c9000)
c10000mean = np.mean(c10000)
c11000mean = np.mean(c11000)
c12000mean = np.mean(c12000)
c14000mean = np.mean(c14000)
c16000mean = np.mean(c16000)
print(c14000mean,c16000mean)
# print('a',np.mean(c1000new),np.var(c1000new),np.std(c1000new))
# print(c2000mean,c3000mean,c4000mean,c5000mean,c6000mean,c7000mean,c8000mean,c9000mean,c10000mean,c11000mean,c12000mean)
# cmean = [0.64489,0.49055,0.18007,0.33907,0.02639,0.04747,0.01965,0.00747,0.00527]#6zu
# cmean = [0.75483,0.47672,0.36772,0.39534,0.03161,0.02976,0.01997,0.008358,0.00923]#12zu
# cmean = [0.75483,0.47672,0.36772,0.2032,0.03161,0.02976,0.01997,0.008358,0.00923]#12zunew
# cmean = [0.03161,0.02976,0.01997,0.008358,0.00923]#2000开始
cmean = [0.033,0.0207,0.0335,0.0165,0.0161,0.0083,0.0067,0.0081,0.0093,0.0079,0.0112,0.0106,0.0109]
# cerrorbar100 = np.std(c100)
# cerrorbar200 = np.std(c200)
# cerrorbar500 = np.std(c500)
# cerrorbar1000 = np.std(c1000)
cerrorbar2000 = np.var(c2000)
cerrorbar3000 = np.var(c3000)
cerrorbar4000 = np.var(c4000)
cerrorbar5000 = np.var(c5000)
cerrorbar6000 = np.var(c6000)
cerrorbar7000 = np.var(c7000)
cerrorbar8000 = np.var(c8000)
cerrorbar9000 = np.var(c9000)
cerrorbar10000 = np.var(c10000)
cerrorbar11000 = np.var(c11000)
cerrorbar12000 = np.var(c12000)
cerrorbar14000 = np.var(c14000)
cerrorbar16000 = np.var(c16000)
print(cerrorbar14000,cerrorbar16000)

# print(cerrorbar2000,cerrorbar3000,cerrorbar4000,cerrorbar5000,cerrorbar6000,cerrorbar7000,cerrorbar8000,cerrorbar9000,cerrorbar10000,cerrorbar11000,cerrorbar12000)
# cvar_list_up = [0.75483+0.2216,0.47672+0.0804,0.36772+0.2932,0.39534+0.5278,0.03161+0.00095,0.02976+0.002,0.01997+0.0004,0.008358+0.00004,0.00923+0.00005]#12zu
# cvar_listdown = [0.75483-0.2216,0.47672-0.0804,0.36772-0.2932,0.39534-0.5278,0.03161-0.00095,0.02976-0.002,0.01997-0.0004,0.008358-0.00004,0.00923-0.00005]#12zu
# bvar = [0.0012,0.0024,0.00071,0.0017,0.0022,0.00167,0.00082,0.000358,0.0018]
cvar_list_up = [0.033+0.00112,0.0207+0.00043,0.0335+0.00242,0.0165+0.00009,0.0161+0.00016,0.0083+0.000015,0.0067+0.00001,0.0081+0.00002,0.0093+0.00007,0.0079+0.00002,0.0112+0.00008,0.0106+0.00006,0.0109+0.00005]#12zu2000开始
cvar_listdown = [0.033-0.00112,0.0207-0.00043,0.0335-0.00242,0.0165-0.00009,0.0161-0.00016,0.0083-0.000015,0.0067-0.00001,0.0081-0.00002,0.0093-0.00007,0.0079-0.00002,0.0112-0.00008,0.0106-0.00006,0.0109-0.00005]#12zu
# cnewvar_list_up = [0.75483+0.2216,0.47672+0.0804,0.36772+0.2932,0.2032+0.1113,0.03161+0.00095,0.02976+0.002,0.01997+0.0004,0.008358+0.00004,0.00923+0.00005]#12zu
# cnewvar_listdown = [0.75483-0.2216,0.47672-0.0804,0.36772-0.2932,0.2032-0.1113,0.03161-0.00095,0.02976-0.002,0.01997-0.0004,0.008358-0.00004,0.00923-0.00005]#12zu
# cstd_list_up = [0.75483+0.4707,0.47672+0.2835,0.36772+0.5415,0.39534+0.7265,0.03161+0.0309,0.02976+0.0457,0.01997+0.0202,0.008358+0.0067,0.00923+0.0077]
# cstd_listdown = [0.75483-0.4707,0.47672-0.2835,0.36772-0.5415,0.39534-0.7265,0.03161-0.0309,0.02976-0.0457,0.01997-0.0202,0.008358-0.0067,0.00923-0.0077]
cstd_list_up = [0.03161+0.0309,0.02976+0.0457,0.01997+0.0202,0.008358+0.0067,0.00923+0.0077]#2000开始
cstd_listdown = [0.03161-0.0309,0.02976-0.0457,0.01997-0.0202,0.008358-0.0067,0.00923-0.0077]

# cnewstd_list_up = [0.75483+0.4707,0.47672+0.2835,0.36772+0.5415,0.2032+0.3337,0.03161+0.0309,0.02976+0.0457,0.01997+0.0202,0.008358+0.0067,0.00923+0.0077]
# cnewstd_listdown = [0.75483-0.4707,0.47672-0.2835,0.36772-0.5415,0.2032-0.3337,0.03161-0.0309,0.02976-0.0457,0.01997-0.0202,0.008358-0.0067,0.00923-0.0077]
cvar = [0.2216,0.0804,0.2932,0.5278,0.00095,0.002,0.0004,0.00004,0.00005]#12zu
cstd = [0.34903,0.17904,0.10179,0.33916,0.03169,0.05876,0.01445,0.00349,0.00096]#6zu
b1 = [0.2413,0.1335,0.1142,0.0713,0.0733,0.1471,0.1018,0.0484,0.0661]#QPNN error
c1 = [0.4504,0.6445,0.1789,0.0949,0.0965,0.0164,0.0407,0.0142,0.0038]#MPNN error
# plt.errorbar(a, bmean, fmt="bo:", yerr=[0.0012,0.0024,0.00071,0.0017,0.0022,0.00167,0.00082,0.000358,0.0018])
# plt.errorbar(a, bmean, fmt="bo:", yerr=[0.03486,0.04899,0.02677,0.04222,0.04703,0.04095,0.02866,0.01893,0.01342])
# plt.errorbar(a, cmean, fmt="ro:", yerr=[0.34903,0.17904,0.10179,0.33916,0.03169,0.05876,0.01445,0.00349,0.00096])
# # plt.plot(a,b)
# # plt.plot(a,c)
# plt.title("error")
# plt.legend(['QPNN','MPNN'])
# plt.show()

fig, ax = plt.subplots()
ax.plot(a,  bmean, color='crimson', linewidth=1, marker="o",markersize=7,markerfacecolor='w', markeredgewidth=1, markeredgecolor='crimson')#markerfacecolor='none'
ax.fill_between(a, bvar_list_up, bvar_listdown, facecolor='crimson', alpha=0.2)#edgecolor='crimson'
# # # ax.fill_between(a, bstd_list_up, bstd_listdown, facecolor='crimson', alpha=0.2)
ax.plot(a,  cmean, color='b', linewidth=1, marker="s",markersize=7, markerfacecolor='w',markeredgewidth=1, markeredgecolor='b')
# # # ax.fill_between(a, cstd_list_up, cstd_listdown, facecolor='b', alpha=0.2)#edgecolor='b'
ax.fill_between(a, cvar_list_up, cvar_listdown, facecolor='b',alpha=0.2)#edgecolor='b',
plt.title("error")
plt.legend(['QPNN','MPNN'],fontsize='x-large',frameon=False)
plt.show()